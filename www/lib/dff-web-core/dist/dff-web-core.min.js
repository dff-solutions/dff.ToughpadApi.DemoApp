!function(){"use strict";var e=window.dff={};e.namespace=function(n){var a,r=n.split("."),t=e;"dff"===r[0]&&(r=r.slice(1));var o,i=e;for(a=0;a<r.length;a++)"undefined"==typeof t[r[a]]&&(t[r[a]]={}),a===r.length-2&&(i=t[r[a]]),o=r[a],t=t[r[a]];return{targetParent:i,targetName:o,bind:function(e){i[o]=e}}},e.define=function(n,a){e.namespace(n).bind(a)},e.namespace("dff.app.com"),e.define("dff.app.com.Shuttle",function(e,n,a,r,t,o,i,u,c){this.MidId=e,this.MiDversion=n,this.MessageId=a,this.BuildingTime=r,this.Net=t,this.Position=o,this.InProgress=i,this.Channel=u,this.HighPrio=c}),e.define("dff.app.com.HeartbeatTicket",function(e,n,a,r,t,o,i,u,c,s,m){this.Zeitpunkt=e,this.MobilgeraetIDENT=n,this.FahrzeugID=a,this.TourID=r,this.Position=t,this.AkkuInfo=o,this.PowerInfo=i,this.StandortID=u,this.StandortIdent=c,this.BenutzerMobilID=s,this.BeifahrerID=m}),e.define("dff.app.com.ShuttleService",function(n,a,r,t,o,i,u,c){function s(e){return p=p.then(function(){return c.reduce(function(n,a){return n.then(function(){return a.onIncomingMessage(e)})},Promise.resolve())})}function m(){"WLAN"===r.getConnection()?S.url=a.settings.IPWLAN:S.url=a.settings.IPGPRS,S.url+=a.settings.ServerRoute,S.action="start",S.interval=a.settings.ShuttleCheckInterval,N.postMessage(S),l=!0}function f(){l&&(N.postMessage({action:"stop"}),l=!1)}function A(a){return a.forEach(function(a){a.MessageId||(n.warn("ShuttleService - onIncomingMessage: MessagId invalid, generating a guid.",a),a.MessageId=e.util.guid.generate())}),i.add(a).then(function(){a.forEach(function(e){s(e)})})["catch"](function(e){throw n.error("ShuttleService - error on incoming message:",e),e})}var d={},p=Promise.resolve(),S={idbSettings:{IDBName:t.dbname,MessageOutgoingStore:o.name,LogfileStore:u.name},messageOutgoingIndex:"BuildingTime",action:null,url:null,interval:1e3},I=!1,E=!1,l=!1,N=new Worker("lib/dff-web-core/src/app/worker/MessageBoxSentShuttlesWorker.js");return c=c||[],N.onmessage=function(e){I=e.data.serverConnection,e.data.error?r.setServerConnected(!1):(r.setServerConnected(!0),A(e.data.response))},N.onerror=function(e){n.error("ShuttleService - worker error:",e)},d.onConnectionChange=function(){f(),r.hasConnection()&&E&&m()},d.addMessageIncomingListener=function(e){c.push(e)},d.sendShuttle=function(e){return o.add(e)["catch"](function(e){throw n.error("ShuttleService - error adding shuttle to MessageOutgoingStore",e),e})},d.outgoingQueueContainsType=function(e){return o.countIndex("Type",{only:e}).then(function(e){return e>0})},d.startService=function(){r.hasConnection()&&m(),E=!0},d.stopService=function(){f(),E=!1},d}),e.define("dff.app.idb.store.LogfileInterceptor",function(e){this.name=e||"Logfile"}),e.app.idb.store.LogfileInterceptor.prototype.onupgradeneeded=function(e){var n=e.target.result;if(!n.objectStoreNames.contains(this.name)){var a=n.createObjectStore(this.name,{keyPath:"id",autoIncrement:!0});a.createIndex("timestamp","timestamp",{unique:!1}),a.createIndex("type","type",{unique:!1})}},e.define("dff.app.idb.store.MessageOutgoingInterceptor",function(e){this.name=e||"MessageOutgoing"}),e.app.idb.store.MessageOutgoingInterceptor.prototype.onupgradeneeded=function(e){var n=e.target.result;if(!n.objectStoreNames.contains(this.name)){var a=n.createObjectStore(this.name,{keyPath:"MessageId"});a.createIndex("Channel","Channel",{unique:!1}),a.createIndex("BuildingTime","BuildingTime",{unique:!1}),a.createIndex("Type","Type",{unique:!1})}},e.define("dff.app.idb.store.MessageIncomingInterceptor",function(e){this.name=e||"MessageIncoming"}),e.app.idb.store.MessageIncomingInterceptor.prototype.onupgradeneeded=function(e){var n=e.target.result;if(!n.objectStoreNames.contains(this.name)){var a=n.createObjectStore(this.name,{keyPath:"MessageId"});a.createIndex("Channel","Channel",{unique:!1}),a.createIndex("BuildingTime","BuildingTime",{unique:!1}),a.createIndex("Type","Type",{unique:!1})}},e.namespace("dff.app.log"),e.define("dff.app.log.LoggingStoreInterceptor",function(n,a,r){function t(e){return a.add(e)["catch"](function(a){n.error("dff.app.log.LoggingStoreInterceptor - error storing logline:",e,a)})}this.log=function(n){return r||n.type!==e.log.Logtype.DEBUG?t(n):void 0}}),e.namespace("dff.datetime"),e.define("dff.datetime.DateTimeService",function(){}),e.datetime.DateTimeService.prototype.getDate=function(){return new Date},e.namespace("dff.dom"),e.define("dff.dom.MutationObserverService",function(){this.observers=[]}),e.dom.MutationObserverService.prototype.addObserver=function(e){this.observers.indexOf(e)<0&&this.observers.push(e)},e.dom.MutationObserverService.prototype.clearObservers=function(){this.observers=[]},e.dom.MutationObserverService.prototype.onMutation=function(e){this.observers.forEach(function(n){n.types.indexOf(e.type)>=0&&n.onMutation(e)})},e.dom.MutationObserverService.prototype.observe=function(e,n){var a=this,r=new MutationObserver(function(e){e.forEach(function(e){a.onMutation(e)})});r.observe(e,n)},e.namespace("dff.gps.tools"),e.define("dff.gps.tools.ToolsService",function(e){var n={},a=e||6378136,r=Math.PI/180;return n.getDistanceDec=function(e,n,t,o){n*=r,e*=r,o*=r,t*=r;var i=o-n,u=t-e,c=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n)*Math.cos(o)*Math.sin(u/2)*Math.sin(u/2),s=2*Math.asin(Math.sqrt(c)),m=a*s;return m},n.dms2Dec=function(e,n,a){var r=1;return 0>e&&(r=-1),r*(r*e+n/60+a/36e3)},n.parseStringDec=function(e){var n=/^(-?)([0-9]*)[\.,]?([0-9]*)$/;if("string"==typeof e){var a,r,t=1,o=n.exec(e);if(!(o&&o.length>=4))throw new Error("unexpected format for strDeg: "+e);"-"===o[1]&&(t=-1),a=o[2]?parseInt(o[2]):0,r=o[3]?parseInt(o[3]):0,e=t*(a+r/Math.pow(10,o[3].length))}return e},n.getLonLatFromDffFence=function(e){var a=/^([0-9]+)@(\d+)\|(\d+)\|(\d+)\|(\d+)\|(\d+)\|(\d+)/,r=a.exec(e);if(r){var t=parseInt(r[2]),o=parseInt(r[3]),i=parseInt(r[4]),u=parseInt(r[5]),c=parseInt(r[6]),s=parseInt(r[7]),m=n.dms2Dec(u,c,s),f=n.dms2Dec(t,o,i);return{lat:m,lon:f}}},n}),e.namespace("dff.idb"),e.define("dff.idb.IDBError",function(e,n){this.event=e,this.msg=n}),e.define("dff.idb.ObjectStore",function(e,n,a){this.openDBPromise=e,this.name=n,this.access=a}),e.idb.ObjectStore.GET_RESOLVE_AS={KEYS:"keys",VALUES:"values",OBJECT:"object"},e.idb.ObjectStore.prototype.getObjectStore=function(n){var a=this,r=n.transaction(a.name,a.access);return r.onerror=function(r){var t="IndexedDBService - error getting object store "+n.name+" version "+n.version+" object store "+a.name;throw new e.idb.IDBError(r,t)},r.onabort=function(a){var r="IndexedDBService - transaction is aborted "+n.name+" version "+n.version;throw new e.idb.IDBError(a,r)},r.objectStore(a.name)},e.idb.ObjectStore.prototype.count=function(){var e=this;return this.openDBPromise.then(function(n){var a=e.getObjectStore(n),r=a.count();return e.handleRequest(r)})},e.idb.ObjectStore.prototype.countIndex=function(e,n){var a=this;return this.openDBPromise.then(function(r){var t=a.getObjectStore(r),o=a.createKeyRange(n),i=t.index(e).count(o);return a.handleRequest(i)})},e.idb.ObjectStore.prototype.add=function(e,n){var a=this;return this.openDBPromise.then(function(r){var t,o=a.getObjectStore(r),i=[];return Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]),e.forEach(function(e,r){t=o.add(e,n[r]),i.push(a.handleRequest(t))}),Promise.all(i)})},e.idb.ObjectStore.prototype.put=function(e,n){var a=this;return this.openDBPromise.then(function(r){var t,o=a.getObjectStore(r),i=[];return Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]),e.forEach(function(e,r){t=o.put(e,n[r]),i.push(a.handleRequest(t))}),Promise.all(i)})},e.idb.ObjectStore.prototype.putObject=function(e){var n=this;return this.openDBPromise.then(function(a){var r,t,o=n.getObjectStore(a),i=[];for(var u in e)t=e[u],"function"!=typeof t&&(r=o.put(t,u),i.push(n.handleRequest(r)));return Promise.all(i)})},e.idb.ObjectStore.prototype.get=function(e){var n=this;return this.openDBPromise.then(function(a){var r=n.getObjectStore(a),t=r.get(e);return n.handleRequest(t)})},e.idb.ObjectStore.prototype.getAll=function(e){var n=this;return this.openDBPromise.then(function(a){var r,t,o,i,u,c=n.getObjectStore(a),s=!1,m=n.createKeyRange(e);return e&&(e.index&&(i=c.index(e.index)),e.resolveAs&&(u=e.resolveAs),e.limit&&(t=e.limit),e.prev?r="prev":e.prevunique?r="prevunique":e.nextunique&&(r="nextunique"),e.createKeyCursor&&(s=!!e.createKeyCursor)),o=i?s?i.openKeyCursor(m,r):m&&r?i.openCursor(m,r):m&&!r?i.openCursor(m):!m&&r?i.openCursor(null,r):i.openCursor():m&&r?c.openCursor(m,r):m&&!r?c.openCursor(m):!m&&r?c.openCursor(null,r):c.openCursor(),n.getAllByCursor(o,t,u)})},e.idb.ObjectStore.prototype.getAllByCursor=function(n,a,r){return new Promise(function(t,o){var i,u=0,c=[],s=[],m={};n.onerror=function(n){var a="IndexedDBService - error on object store:";o(new e.idb.IDBError(n,a))},n.onsuccess=function(n){var o;i=n.target.result,i&&(!a||a>u)?(o="undefined"!=typeof i.value?i.value:i.primaryKey,c.push(o),s.push(i.key),r===e.idb.ObjectStore.GET_RESOLVE_AS.OBJECT&&(m[i.key]=o),u++,i["continue"]()):t(r===e.idb.ObjectStore.GET_RESOLVE_AS.KEYS?s:r===e.idb.ObjectStore.GET_RESOLVE_AS.OBJECT?m:c)}})},e.idb.ObjectStore.prototype.getKeys=function(){return this.getAll({resolveAs:e.idb.ObjectStore.GET_RESOLVE_AS.KEYS})},e.idb.ObjectStore.prototype.clear=function(){var e=this;return this.openDBPromise.then(function(n){var a=e.getObjectStore(n),r=a.clear();return e.handleRequest(r)})},e.idb.ObjectStore.prototype["delete"]=function(e){var n=this;return this.openDBPromise.then(function(a){var r=[],t=n.getObjectStore(a);return Array.isArray(e)||(e=[e]),e.forEach(function(e){var a=t["delete"](e);r.push(n.handleRequest(a))}),Promise.all(r)})},e.idb.ObjectStore.prototype.createKeyRange=function(e){var n=null;return e&&("undefined"!=typeof e.only?n=IDBKeyRange.only(e.only):"undefined"!=typeof e.lowerBound?n=IDBKeyRange.lowerBound(e.lowerBound.lower,!!e.lowerBound.lowerOpen):"undefined"!=typeof e.upperBound?n=IDBKeyRange.upperBound(e.upperBound.upper,!!e.upperBound.upperOpen):"undefined"!=typeof e.bound&&(n=IDBKeyRange.bound(e.bound.lower,e.bound.upper,!!e.bound.lowerOpen,!!e.bound.upperOpen))),n},e.idb.ObjectStore.prototype.handleRequest=function(n){return new Promise(function(a,r){n.onsuccess=function(){a(n.result)},n.onerror=function(n){var a="IndexedDBService - error on object store:";r(new e.idb.IDBError(n,a))}})},e.idb.ObjectStore.prototype.toString=function(){return this.name},e.define("dff.idb.IndexedDBService",function(e,n,a,r){var t=this;this.dbname=e,this.dbversion=n,this.log=r,this.upgradeInterceptors=a,this.openDBPromise=this.openDB().then(function(e){return t.db=e,e})["catch"](function(e){throw t.log.error(e),e})}),e.idb.IndexedDBService.prototype.getOpenDBPromise=function(){return this.openDBPromise},e.idb.IndexedDBService.prototype.openDB=function(){var n=this;return new Promise(function(a,r){var t=indexedDB.open(n.dbname,n.dbversion);t.onerror=function(a){var t="IndexedDBService - error openening database "+n.dbname+" version "+n.dbversion;r(new e.idb.IDBError(a,t))},t.onblocked=function(a){var t="IndexedDBService - error openening database "+n.dbname+" version "+n.dbversion+" db is blocked";r(new e.idb.IDBError(a,t))},t.onsuccess=function(){var e=t.result;e.onerror=function(a){var r="IndexedDBService - database error "+e.name+" version "+e.version+" error code "+a.target.errorCode;n.log.error(r,a)},e.onabort=function(a){var r="IndexedDBService - access of the database is aborted "+e.name+" version "+e.version;n.log.error(r,a)},a(e)},t.onupgradeneeded=function(e){var a=t.result;a.onversionchange=function(){a.close()},n.upgradeInterceptors.forEach(function(n){n.onupgradeneeded(e)})}})},e.idb.IndexedDBService.prototype.getObjectStore=function(n,a){return new e.idb.ObjectStore(this.openDBPromise,n,a)},e.namespace("dff.idb.store"),e.define("dff.idb.store.SettingsInterceptor",function(e){this.name=e||"Settings"}),e.idb.store.SettingsInterceptor.prototype.onupgradeneeded=function(e){var n=e.target.result;n.objectStoreNames.contains(this.name)||n.createObjectStore(this.name)},e.define("dff.idb.store.DataInterceptor",function(e){this.name=e||"Data"}),e.idb.store.DataInterceptor.prototype.onupgradeneeded=function(e){var n=e.target.result;n.objectStoreNames.contains(this.name)||n.createObjectStore(this.name)},e.namespace("dff.iso.3166"),e.define("dff.iso.3166.codes",[{name:"AALAND ISLANDS",a2:"AX",a3:"ALA",number:"248"},{name:"AFGHANISTAN",a2:"AF",a3:"AFG",number:"004"},{name:"ALBANIA",a2:"AL",a3:"ALB",number:"008"},{name:"ALGERIA",a2:"DZ",a3:"DZA",number:"012"},{name:"AMERICAN SAMOA",a2:"AS",a3:"ASM",number:"016"},{name:"ANDORRA",a2:"AD",a3:"AND",number:"020"},{name:"ANGOLA",a2:"AO",a3:"AGO",number:"024"},{name:"ANGUILLA",a2:"AI",a3:"AIA",number:"660"},{name:"ANTARCTICA",a2:"AQ",a3:"ATA",number:"010"},{name:"ANTIGUA AND BARBUDA",a2:"AG",a3:"ATG",number:"028"},{name:"ARGENTINA",a2:"AR",a3:"ARG",number:"032"},{name:"ARMENIA",a2:"AM",a3:"ARM",number:"051"},{name:"ARUBA",a2:"AW",a3:"ABW",number:"533"},{name:"AUSTRALIA",a2:"AU",a3:"AUS",number:"036"},{name:"AUSTRIA",a2:"AT",a3:"AUT",number:"040"},{name:"AZERBAIJAN",a2:"AZ",a3:"AZE",number:"031"},{name:"BAHAMAS",a2:"BS",a3:"BHS",number:"044"},{name:"BAHRAIN",a2:"BH",a3:"BHR",number:"048"},{name:"BANGLADESH",a2:"BD",a3:"BGD",number:"050"},{name:"BARBADOS",a2:"BB",a3:"BRB",number:"052"},{name:"BELARUS",a2:"BY",a3:"BLR",number:"112"},{name:"BELGIUM",a2:"BE",a3:"BEL",number:"056"},{name:"BELIZE",a2:"BZ",a3:"BLZ",number:"084"},{name:"BENIN",a2:"BJ",a3:"BEN",number:"204"},{name:"BERMUDA",a2:"BM",a3:"BMU",number:"060"},{name:"BHUTAN",a2:"BT",a3:"BTN",number:"064"},{name:"BOLIVIA",a2:"BO",a3:"BOL",number:"068"},{name:"BOSNIA AND HERZEGOWINA",a2:"BA",a3:"BIH",number:"070"},{name:"BOTSWANA",a2:"BW",a3:"BWA",number:"072"},{name:"BOUVET ISLAND",a2:"BV",a3:"BVT",number:"074"},{name:"BRAZIL",a2:"BR",a3:"BRA",number:"076"},{name:"BRITISH INDIAN OCEAN TERRITORY",a2:"IO",a3:"IOT",number:"086"},{name:"BRUNEI DARUSSALAM",a2:"BN",a3:"BRN",number:"096"},{name:"BULGARIA",a2:"BG",a3:"BGR",number:"100"},{name:"BURKINA FASO",a2:"BF",a3:"BFA",number:"854"},{name:"BURUNDI",a2:"BI",a3:"BDI",number:"108"},{name:"CAMBODIA",a2:"KH",a3:"KHM",number:"116"},{name:"CAMEROON",a2:"CM",a3:"CMR",number:"120"},{name:"CANADA",a2:"CA",a3:"CAN",number:"124"},{name:"CAPE VERDE",a2:"CV",a3:"CPV",number:"132"},{name:"CAYMAN ISLANDS",a2:"KY",a3:"CYM",number:"136"},{name:"CENTRAL AFRICAN REPUBLIC",a2:"CF",a3:"CAF",number:"140"},{name:"CHAD",a2:"TD",a3:"TCD",number:"148"},{name:"CHILE",a2:"CL",a3:"CHL",number:"152"},{name:"CHINA",a2:"CN",a3:"CHN",number:"156"},{name:"CHRISTMAS ISLAND",a2:"CX",a3:"CXR",number:"162"},{name:"COCOS (KEELING) ISLANDS",a2:"CC",a3:"CCK",number:"166"},{name:"COLOMBIA",a2:"CO",a3:"COL",number:"170"},{name:"COMOROS",a2:"KM",a3:"COM",number:"174"},{name:"CONGO, Democratic Republic of (was Zaire)",a2:"CD",a3:"COD",number:"180"},{name:"CONGO, Republic of",a2:"CG",a3:"COG",number:"178"},{name:"COOK ISLANDS",a2:"CK",a3:"COK",number:"184"},{name:"COSTA RICA",a2:"CR",a3:"CRI",number:"188"},{name:"COTE D'IVOIRE",a2:"CI",a3:"CIV",number:"384"},{name:"CROATIA (local name: Hrvatska)",a2:"HR",a3:"HRV",number:"191"},{name:"CUBA",a2:"CU",a3:"CUB",number:"192"},{name:"CYPRUS",a2:"CY",a3:"CYP",number:"196"},{name:"CZECH REPUBLIC",a2:"CZ",a3:"CZE",number:"203"},{name:"DENMARK",a2:"DK",a3:"DNK",number:"208"},{name:"DJIBOUTI",a2:"DJ",a3:"DJI",number:"262"},{name:"DOMINICA",a2:"DM",a3:"DMA",number:"212"},{name:"DOMINICAN REPUBLIC",a2:"DO",a3:"DOM",number:"214"},{name:"ECUADOR",a2:"EC",a3:"ECU",number:"218"},{name:"EGYPT",a2:"EG",a3:"EGY",number:"818"},{name:"EL SALVADOR",a2:"SV",a3:"SLV",number:"222"},{name:"EQUATORIAL GUINEA",a2:"GQ",a3:"GNQ",number:"226"},{name:"ERITREA",a2:"ER",a3:"ERI",number:"232"},{name:"ESTONIA",a2:"EE",a3:"EST",number:"233"},{name:"ETHIOPIA",a2:"ET",a3:"ETH",number:"231"},{name:"FALKLAND ISLANDS (MALVINAS)",a2:"FK",a3:"FLK",number:"238"},{name:"FAROE ISLANDS",a2:"FO",a3:"FRO",number:"234"},{name:"FIJI",a2:"FJ",a3:"FJI",number:"242"},{name:"FINLAND",a2:"FI",a3:"FIN",number:"246"},{name:"FRANCE",a2:"FR",a3:"FRA",number:"250"},{name:"FRENCH GUIANA",a2:"GF",a3:"GUF",number:"254"},{name:"FRENCH POLYNESIA",a2:"PF",a3:"PYF",number:"258"},{name:"FRENCH SOUTHERN TERRITORIES",a2:"TF",a3:"ATF",number:"260"},{name:"GABON",a2:"GA",a3:"GAB",number:"266"},{name:"GAMBIA",a2:"GM",a3:"GMB",number:"270"},{name:"GEORGIA",a2:"GE",a3:"GEO",number:"268"},{name:"GERMANY",a2:"DE",a3:"DEU",number:"276"},{name:"GHANA",a2:"GH",a3:"GHA",number:"288"},{name:"GIBRALTAR",a2:"GI",a3:"GIB",number:"292"},{name:"GREECE",a2:"GR",a3:"GRC",number:"300"},{name:"GREENLAND",a2:"GL",a3:"GRL",number:"304"},{name:"GRENADA",a2:"GD",a3:"GRD",number:"308"},{name:"GUADELOUPE",a2:"GP",a3:"GLP",number:"312"},{name:"GUAM",a2:"GU",a3:"GUM",number:"316"},{name:"GUATEMALA",a2:"GT",a3:"GTM",number:"320"},{name:"GUINEA",a2:"GN",a3:"GIN",number:"324"},{name:"GUINEA-BISSAU",a2:"GW",a3:"GNB",number:"624"},{name:"GUYANA",a2:"GY",a3:"GUY",number:"328"},{name:"HAITI",a2:"HT",a3:"HTI",number:"332"},{name:"HEARD AND MC DONALD ISLANDS",a2:"HM",a3:"HMD",number:"334"},{name:"HONDURAS",a2:"HN",a3:"HND",number:"340"},{name:"HONG KONG",a2:"HK",a3:"HKG",number:"344"},{name:"HUNGARY",a2:"HU",a3:"HUN",number:"348"},{name:"ICELAND",a2:"IS",a3:"ISL",number:"352"},{name:"INDIA",a2:"IN",a3:"IND",number:"356"},{name:"INDONESIA",a2:"ID",a3:"IDN",number:"360"},{name:"IRAN (ISLAMIC REPUBLIC OF)",a2:"IR",a3:"IRN",number:"364"},{name:"IRAQ",a2:"IQ",a3:"IRQ",number:"368"},{name:"IRELAND",a2:"IE",a3:"IRL",number:"372"},{name:"ISRAEL",a2:"IL",a3:"ISR",number:"376"},{name:"ITALY",a2:"IT",a3:"ITA",number:"380"},{name:"JAMAICA",a2:"JM",a3:"JAM",number:"388"},{name:"JAPAN",a2:"JP",a3:"JPN",number:"392"},{name:"JORDAN",a2:"JO",a3:"JOR",number:"400"},{name:"KAZAKHSTAN",a2:"KZ",a3:"KAZ",number:"398"},{name:"KENYA",a2:"KE",a3:"KEN",number:"404"},{name:"KIRIBATI",a2:"KI",a3:"KIR",number:"296"},{name:"KOREA, DEMOCRATIC PEOPLE'S REPUBLIC OF",a2:"KP",a3:"PRK",number:"408"},{name:"KOREA, REPUBLIC OF",a2:"KR",a3:"KOR",number:"410"},{name:"KUWAIT",a2:"KW",a3:"KWT",number:"414"},{name:"KYRGYZSTAN",a2:"KG",a3:"KGZ",number:"417"},{name:"LAO PEOPLE'S DEMOCRATIC REPUBLIC",a2:"LA",a3:"LAO",number:"418"},{name:"LATVIA",a2:"LV",a3:"LVA",number:"428"},{name:"LEBANON",a2:"LB",a3:"LBN",number:"422"},{name:"LESOTHO",a2:"LS",a3:"LSO",number:"426"},{name:"LIBERIA",a2:"LR",a3:"LBR",number:"430"},{name:"LIBYAN ARAB JAMAHIRIYA",a2:"LY",a3:"LBY",number:"434"},{name:"LIECHTENSTEIN",a2:"LI",a3:"LIE",number:"438"},{name:"LITHUANIA",a2:"LT",a3:"LTU",number:"440"},{name:"LUXEMBOURG",a2:"LU",a3:"LUX",number:"442"},{name:"MACAU",a2:"MO",a3:"MAC",number:"446"},{name:"MACEDONIA, THE FORMER YUGOSLAV REPUBLIC OF",a2:"MK",a3:"MKD",number:"807"},{name:"MADAGASCAR",a2:"MG",a3:"MDG",number:"450"},{name:"MALAWI",a2:"MW",a3:"MWI",number:"454"},{name:"MALAYSIA",a2:"MY",a3:"MYS",number:"458"},{name:"MALDIVES",a2:"MV",a3:"MDV",number:"462"},{name:"MALI",a2:"ML",a3:"MLI",number:"466"},{name:"MALTA",a2:"MT",a3:"MLT",number:"470"},{name:"MARSHALL ISLANDS",a2:"MH",a3:"MHL",number:"584"},{name:"MARTINIQUE",a2:"MQ",a3:"MTQ",number:"474"},{name:"MAURITANIA",a2:"MR",a3:"MRT",number:"478"},{name:"MAURITIUS",a2:"MU",a3:"MUS",number:"480"},{name:"MAYOTTE",a2:"YT",a3:"MYT",number:"175"},{name:"MEXICO",a2:"MX",a3:"MEX",number:"484"},{name:"MICRONESIA, FEDERATED STATES OF",a2:"FM",a3:"FSM",number:"583"},{name:"MOLDOVA, REPUBLIC OF",a2:"MD",a3:"MDA",number:"498"},{name:"MONACO",a2:"MC",a3:"MCO",number:"492"},{name:"MONGOLIA",a2:"MN",a3:"MNG",number:"496"},{name:"MONTSERRAT",a2:"MS",a3:"MSR",number:"500"},{name:"MOROCCO",a2:"MA",a3:"MAR",number:"504"},{name:"MOZAMBIQUE",a2:"MZ",a3:"MOZ",number:"508"},{name:"MYANMAR",a2:"MM",a3:"MMR",number:"104"},{name:"NAMIBIA",a2:"NA",a3:"NAM",number:"516"},{name:"NAURU",a2:"NR",a3:"NRU",number:"520"},{name:"NEPAL",a2:"NP",a3:"NPL",number:"524"},{name:"NETHERLANDS",a2:"NL",a3:"NLD",number:"528"},{name:"NETHERLANDS ANTILLES",a2:"AN",a3:"ANT",number:"530"},{name:"NEW CALEDONIA",a2:"NC",a3:"NCL",number:"540"},{name:"NEW ZEALAND",a2:"NZ",a3:"NZL",number:"554"},{name:"NICARAGUA",a2:"NI",a3:"NIC",number:"558"},{name:"NIGER",a2:"NE",a3:"NER",number:"562"},{name:"NIGERIA",a2:"NG",a3:"NGA",number:"566"},{name:"NIUE",a2:"NU",a3:"NIU",number:"570"},{name:"NORFOLK ISLAND",a2:"NF",a3:"NFK",number:"574"},{name:"NORTHERN MARIANA ISLANDS",a2:"MP",a3:"MNP",number:"580"},{name:"NORWAY",a2:"NO",a3:"NOR",number:"578"},{name:"OMAN",a2:"OM",a3:"OMN",number:"512"},{name:"PAKISTAN",a2:"PK",a3:"PAK",number:"586"},{name:"PALAU",a2:"PW",a3:"PLW",number:"585"},{name:"PALESTINIAN TERRITORY, Occupied",a2:"PS",a3:"PSE",number:"275"},{name:"PANAMA",a2:"PA",a3:"PAN",number:"591"},{name:"PAPUA NEW GUINEA",a2:"PG",a3:"PNG",number:"598"},{name:"PARAGUAY",a2:"PY",a3:"PRY",number:"600"},{name:"PERU",a2:"PE",a3:"PER",number:"604"},{name:"PHILIPPINES",a2:"PH",a3:"PHL",number:"608"},{name:"PITCAIRN",a2:"PN",a3:"PCN",number:"612"},{name:"POLAND",a2:"PL",a3:"POL",number:"616"},{name:"PORTUGAL",a2:"PT",a3:"PRT",number:"620"},{name:"PUERTO RICO",a2:"PR",a3:"PRI",number:"630"},{name:"QATAR",a2:"QA",a3:"QAT",number:"634"},{name:"REUNION",a2:"RE",a3:"REU",number:"638"},{name:"ROMANIA",a2:"RO",a3:"ROU",number:"642"},{name:"RUSSIAN FEDERATION",a2:"RU",a3:"RUS",number:"643"},{name:"RWANDA",a2:"RW",a3:"RWA",number:"646"},{name:"SAINT HELENA",a2:"SH",a3:"SHN",number:"654"},{name:"SAINT KITTS AND NEVIS",a2:"KN",a3:"KNA",number:"659"},{name:"SAINT LUCIA",a2:"LC",a3:"LCA",number:"662"},{name:"SAINT PIERRE AND MIQUELON",a2:"PM",a3:"SPM",number:"666"},{name:"SAINT VINCENT AND THE GRENADINES",a2:"VC",a3:"VCT",number:"670"},{name:"SAMOA",a2:"WS",a3:"WSM",number:"882"},{name:"SAN MARINO",a2:"SM",a3:"SMR",number:"674"},{name:"SAO TOME AND PRINCIPE",a2:"ST",a3:"STP",number:"678"},{name:"SAUDI ARABIA",a2:"SA",a3:"SAU",number:"682"},{name:"SENEGAL",a2:"SN",a3:"SEN",number:"686"},{name:"SERBIA AND MONTENEGRO",a2:"CS",a3:"SCG",number:"891"},{name:"SEYCHELLES",a2:"SC",a3:"SYC",number:"690"},{name:"SIERRA LEONE",a2:"SL",a3:"SLE",number:"694"},{name:"SINGAPORE",a2:"SG",a3:"SGP",number:"702"},{name:"SLOVAKIA",a2:"SK",a3:"SVK",number:"703"},{name:"SLOVENIA",a2:"SI",a3:"SVN",number:"705"},{name:"SOLOMON ISLANDS",a2:"SB",a3:"SLB",number:"090"},{name:"SOMALIA",a2:"SO",a3:"SOM",number:"706"},{name:"SOUTH AFRICA",a2:"ZA",a3:"ZAF",number:"710"},{name:"SOUTH GEORGIA AND THE SOUTH SANDWICH ISLANDS",a2:"GS",a3:"SGS",number:"239"},{name:"SPAIN",a2:"ES",a3:"ESP",number:"724"},{name:"SRI LANKA",a2:"LK",a3:"LKA",number:"144"},{name:"SUDAN",a2:"SD",a3:"SDN",number:"736"},{name:"SURINAME",a2:"SR",a3:"SUR",number:"740"},{name:"SVALBARD AND JAN MAYEN ISLANDS",a2:"SJ",a3:"SJM",number:"744"},{name:"SWAZILAND",a2:"SZ",a3:"SWZ",number:"748"},{name:"SWEDEN",a2:"SE",a3:"SWE",number:"752"},{name:"SWITZERLAND",a2:"CH",a3:"CHE",number:"756"},{name:"SYRIAN ARAB REPUBLIC",a2:"SY",a3:"SYR",number:"760"},{name:"TAIWAN",a2:"TW",a3:"TWN",number:"158"},{name:"TAJIKISTAN",a2:"TJ",a3:"TJK",number:"762"},{name:"TANZANIA, UNITED REPUBLIC OF",a2:"TZ",a3:"TZA",number:"834"},{name:"THAILAND",a2:"TH",a3:"THA",number:"764"},{name:"TIMOR-LESTE",a2:"TL",a3:"TLS",number:"626"},{name:"TOGO",a2:"TG",a3:"TGO",number:"768"},{name:"TOKELAU",a2:"TK",a3:"TKL",number:"772"},{name:"TONGA",a2:"TO",a3:"TON",number:"776"},{name:"TRINIDAD AND TOBAGO",a2:"TT",a3:"TTO",number:"780"},{name:"TUNISIA",a2:"TN",a3:"TUN",number:"788"},{name:"TURKEY",a2:"TR",a3:"TUR",number:"792"},{name:"TURKMENISTAN",a2:"TM",a3:"TKM",number:"795"},{name:"TURKS AND CAICOS ISLANDS",a2:"TC",a3:"TCA",number:"796"},{name:"TUVALU",a2:"TV",a3:"TUV",number:"798"},{name:"UGANDA",a2:"UG",a3:"UGA",number:"800"},{name:"UKRAINE",a2:"UA",a3:"UKR",number:"804"},{name:"UNITED ARAB EMIRATES",a2:"AE",a3:"ARE",number:"784"},{name:"UNITED KINGDOM",a2:"GB",a3:"GBR",number:"826"},{name:"UNITED STATES",a2:"US",a3:"USA",number:"840"},{name:"UNITED STATES MINOR OUTLYING ISLANDS",a2:"UM",a3:"UMI",number:"581"},{name:"URUGUAY",a2:"UY",a3:"URY",number:"858"},{name:"UZBEKISTAN",a2:"UZ",a3:"UZB",number:"860"},{name:"VANUATU",a2:"VU",a3:"VUT",number:"548"},{name:"VATICAN CITY STATE (HOLY SEE)",a2:"VA",a3:"VAT",number:"336"},{name:"VENEZUELA",a2:"VE",a3:"VEN",number:"862"},{name:"VIET NAM",a2:"VN",a3:"VNM",number:"704"},{name:"VIRGIN ISLANDS (BRITISH)",a2:"VG",a3:"VGB",number:"092"},{name:"VIRGIN ISLANDS (U.S.)",a2:"VI",a3:"VIR",number:"850"},{name:"WALLIS AND FUTUNA ISLANDS",a2:"WF",a3:"WLF",number:"876"},{name:"WESTERN SAHARA",a2:"EH",a3:"ESH",number:"732"},{name:"YEMEN",a2:"YE",a3:"YEM",number:"887"},{name:"ZAMBIA",a2:"ZM",a3:"ZMB",number:"894"},{name:"ZIMBABWE",a2:"ZW",a3:"ZWE",number:"716"}]),e.define("dff.iso.3166.CodeService",function(){var n={},a=/^[0-9]{3}$/;return n.getCountryCode=function(n){if("string"==typeof n){if(a.test(n))return _.find(e.iso[3166].codes,function(e){return e.number===n});if(2===n.length)return _.find(e.iso[3166].codes,function(e){return e.a2===n});if(3===n.length)return _.find(e.iso[3166].codes,function(e){return e.a3===n});var r=n.toLowerCase();return _.find(e.iso[3166].codes,function(e){return e.name.toLowerCase()===r})}return"number"==typeof n?_.find(e.iso[3166].codes,function(e){return parseInt(e.number)===n}):void 0},n}),e.namespace("dff.log"),e.define("dff.log.Logtype",{LOG:"LOG",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR"}),e.define("dff.log.Logline",function(e,n,a){this.type=e,this.content=n,this.timestamp=a}),e.define("dff.log.LoggingService",function(e,n,a){this.logObject=e||console,this.logInterceptors=n||[],this.dateTimeService=a,this.notificationPromise=Promise.resolve()}),e.log.LoggingService.concatArgs=function(e){for(var n="",a=0;a<e.length;a++)a>0&&(n+=" "),e[a]&&"function"==typeof e[a].toString()?n=n.concat(e[a].toString()):n+=e[a];return n},e.log.LoggingService.prototype.addInterceptor=function(e){this.logInterceptors.push(e)},e.log.LoggingService.prototype.log=function(){return this.logObject.log.apply(this.logObject,arguments),this.notifyInterceptors(e.log.Logtype.LOG,arguments)},e.log.LoggingService.prototype.info=function(){return this.logObject.info.apply(this.logObject,arguments),this.notifyInterceptors(e.log.Logtype.INFO,arguments)},e.log.LoggingService.prototype.debug=function(){return this.logObject.debug.apply(this.logObject,arguments),this.notifyInterceptors(e.log.Logtype.DEBUG,arguments)},e.log.LoggingService.prototype.warn=function(){return this.logObject.warn.apply(this.logObject,arguments),this.notifyInterceptors(e.log.Logtype.WARN,arguments)},e.log.LoggingService.prototype.error=function(){return this.logObject.error.apply(this.logObject,arguments),this.notifyInterceptors(e.log.Logtype.ERROR,arguments)},e.log.LoggingService.prototype.notifyInterceptors=function(n,a){var r=this,t=e.log.LoggingService.concatArgs(a),o=this.dateTimeService.getDate(),i=new e.log.Logline(n,t,o);return this.notificationPromise=this.notificationPromise.then(function(){return r.logInterceptors.reduce(function(e,n){return e.then(function(){return n.log(i)})},Promise.resolve("reduce interceptors"))}),this.notificationPromise},e.namespace("dff.settings"),e.define("dff.settings.SettingsService",function(n,a){var r={settings:{}};return r.startPromise=n.getAll({resolveAs:e.idb.ObjectStore.GET_RESOLVE_AS.OBJECT}).then(function(e){r.settings=_.assign({},a,e)}),r.startService=function(){return r.startPromise},r.clear=function(){return r.settings={},n.clear()},r.reset=function(){return r.settings=_.assign({},a),r.save()},r.save=function(){return n.clear().then(function(){return n.putObject(r.settings)})},r}),e.namespace("dff.storage"),e.define("dff.storage.StorageService",function(e){var n={};return n.getStorageInfo=function(){var n=new Promise(function(n,a){e.navigator.webkitTemporaryStorage.queryUsageAndQuota(function(e,a){n({used:e,granted:a})},function(e){a(e)})}),a=new Promise(function(n,a){e.navigator.webkitPersistentStorage.queryUsageAndQuota(function(e,a){n({used:e,granted:a})},function(e){a(e)})});return Promise.all([n,a])},n}),e.namespace("dff.util"),e.define("dff.util.guid",{S4:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},generate:function(){var e=(this.S4()+this.S4()+"-"+this.S4()+"-4"+this.S4().substr(0,3)+"-"+this.S4()+"-"+this.S4()+this.S4()+this.S4()).toLowerCase();return e}}),e.namespace("dff.app.cordova.common"),e.define("dff.app.cordova.common.PluginService",function(e,n,a){var r={};return r.startService=function(){return new Promise(function(r,t){e.CommonPlugin?(e.CommonPlugin.onLog(function(e){var r="plugin log ("+e.tag+"):";switch(e.type){case a.LOG:n.log(r,e.msg);break;case a.DEBUG:n.debug(r,e.msg);break;case a.INFO:n.info(r,e.msg);break;case a.WARN:n.warn(r,e.msg);break;case a.ERROR:n.error(r,e.msg,e.tr,e.stackTrace)}},function(e){n.error(e)}),r()):t("common plugin not available")})},r}),e.namespace("dff.app.cordova.connection"),e.define("dff.app.cordova.connection.ConnectionService",function(e,n,a,r){function t(){e.navigator.connection?(e.document.addEventListener("online",s.checkConnection,!1),e.document.addEventListener("offline",s.checkConnection,!1),s.checkConnection()):n.error("dffAppConnectionService:","cordova connection plugin not available")}function o(e){return m=m.then(function(){return a.reduce(function(n,a){return n.then(function(){return a.onConnectionChange(e)})},Promise.resolve())})}function i(e){return f=f.then(function(){return r.reduce(function(n,a){return n.then(function(){return a.onServerConnectionChange(e)})},Promise.resolve())})}var u,c,s={};a=a||[],r=r||[];var m=Promise.resolve(),f=Promise.resolve();return s.addConnectionChangeListener=function(e){a.push(e)},s.addServerConnectionChangeListener=function(e){r.push(e)},s.checkConnection=function(){var e=u,a=navigator.connection.type;return n.info("dffAppConnectionService - ","checkConnection",a),a===Connection.WIFI?u="WLAN":a===Connection.NONE?(u=Connection.NONE,c=!1):u="GPRS",e!==u?(n.info("dffAppConnectionService - ","new connection:",u),o(u)):Promise.resolve("connection has not changed")},s.getConnection=function(){return u},s.setConnection=function(e){return u!==e?(u=e,o(u)):Promise.resolve("connection has not changed")},s.hasConnection=function(){return u&&u!==Connection.NONE},s.setServerConnected=function(e){return c=e,i(e)},s.isServerConnected=function(){return c},s.hasServerConnection=function(){return s.hasConnection()&&c},s.startService=function(){e.document.addEventListener("deviceready",t,!1)},s.stopService=function(){e.document.removeEventListener("deviceready",t,!1),e.document.removeEventListener("online",s.checkConnection,!1),e.document.removeEventListener("offline",s.checkConnection,!1)},s}),e.namespace("dff.app.cordova.file"),e.define("dff.app.cordova.file.FileError",function(e,n,a){this.fileError=e,this.msg=n,this.desc=a}),e.define("dff.app.cordova.file.FileService",function(){}),e.app.cordova.file.FileService.getFileErrorDesc=function(e){var n="";switch(e.code){case FileError.NOT_FOUND_ERR:n="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:n="SECURITY_ERR";break;case FileError.ABORT_ERR:n="ABORT_ERR";break;case FileError.NOT_READABLE_ERR:n="NOT_READABLE_ERR";break;case FileError.ENCODING_ERR:n="ENCODING_ERR";break;case FileError.NO_MODIFICATION_ALLOWED_ERR:n="NO_MODIFICATION_ALLOWED_ERR";break;case FileError.INVALID_STATE_ERR:n="INVALID_STATE_ERR";break;case FileError.SYNTAX_ERR:n="SYNTAX_ERR";break;case FileError.INVALID_MODIFICATION_ERR:n="INVALID_MODIFICATION_ERR";break;case FileError.QUOTA_EXCEEDED_ERR:n="QUOTA_EXCEEDED_ERR";break;case FileError.TYPE_MISMATCH_ERR:n="TYPE_MISMATCH_ERR";break;case FileError.PATH_EXISTS_ERR:n="PATH_EXISTS_ERR"}return n},e.app.cordova.file.FileService.resolveLocalFileSystemURL=function(n,a){return new Promise(function(r,t){n.resolveLocalFileSystemURL(a,function(e){r(e)},function(n){t(new e.app.cordova.file.FileError(n,"error resolve filesystem "+a,e.app.cordova.file.FileService.getFileErrorDesc(n)))})})},e.app.cordova.file.FileService.getDirectory=function(n,a,r,t){var o=n.split(/\/|\\/);return o.reduce(function(a,o){
return o?a.then(function(a){return new Promise(function(i,u){a.getDirectory(o,{create:r,exclusive:t},function(e){i(e)},function(a){u(new e.app.cordova.file.FileError(a,"error getting directory "+n,e.app.cordova.file.FileService.getFileErrorDesc(a)))})})}):a},Promise.resolve(a))},e.namespace("dff.app.cordova.telephony"),e.define("dff.app.cordova.telephony.TelephonyService",function(e,n,a,r,t){function o(){e.Telephony?e.Telephony.onCallStateChanged(function(e){i(e)},function(e){a.error(e)}):a.error("Telephony plugin not available")}function i(e){r.forEach(function(n){"function"==typeof n.onCallStateChanged?n.onCallStateChanged(e):a.error("TelephonyService notifyCallStateListeners onCallStateChanged missing",n)})}var u={telephonyinfo:{}};return r=r||[],u.onCallStateChanged=function(e){r.push({onCallStateChanged:e})},u.setCallprefix=function(e){t=e},u.getCallprefix=function(){return t},u.loadTelephonyInfo=function(){return new Promise(function(n,a){e.Telephony?e.Telephony.telephonyinfo(function(e){u.telephonyinfo=e,n(e)},function(e){u.telephonyinfo={},a(e)}):a("Telephony plugin not available")})},u.loadCallsLog=function(){return new Promise(function(n,a){e.Telephony?e.Telephony.getCallsLog(function(e){n(e)},function(e){a(e)}):a("Telephony plugin not available")})},u.clearCallsLog=function(n){return new Promise(function(a,r){e.Telephony?n&&"string"==typeof n?e.Telephony.clearCalllog(function(e){a(e)},function(e){r(e)},{where:n}):e.Telephony.clearCalllog(function(e){a(e)},function(e){r(e)},{}):r("Telephony plugin not available")})},u.call=function(n){return new Promise(function(r,o){n?("undefined"!=typeof t&&(n=t+n),e.Telephony.call(function(){r()},function(e){a.error(e),o(e)},{number:n})):o("no valid number")})},u.startService=function(){return e.Telephony&&e.Telephony.onLog(function(e){var r="TelephonyService ("+e.tag+"):";switch(e.type){case n.LOG:a.log(r,e.msg);break;case n.DEBUG:a.debug(r,e.msg);break;case n.INFO:a.info(r,e.msg);break;case n.WARN:a.warn(r,e.msg);break;case n.ERROR:a.error(r,e.msg,e.tr,e.stackTrace)}},function(e){a.error(e)}),u.loadTelephonyInfo()},e.document.addEventListener("deviceready",o,!1),u}),e.namespace("dff.app.cordova.wifi.manager"),e.define("dff.app.cordova.wifi.manager.WifiStateLogger",function(e){return{onWifiStateChanged:function(n){e.info("wifi state change from:",n.previous_wifi_stateName,"to:",n.wifi_stateName)}}}),e.define("dff.app.cordova.wifi.manager.NetworkStateLogger",function(e){return{onNetworkStateChanged:function(n){n&&(n.networkInfo&&e.info("network state - network info:","state:",n.networkInfo.state,"extraInfo:",n.networkInfo.extraInfo),n.wifiInfo&&e.info("network state - wifi info:","ssid:",n.wifiInfo.ssid,"rssi:",n.wifiInfo.rssi,"linkSpeed:",n.wifiInfo.linkSpeed))}}}),e.define("dff.app.cordova.wifi.manager.ScanResultsLogger",function(e){return{onScanResultsAvailable:function(n){e.log("wifi scan results available:",n)}}}),e.define("dff.app.cordova.wifi.manager.Service",function(e,n,a,r,t){var o={};return a=a||[],r=r||[],t=t||[],o.notifyNetworkStateChangeListeners=function(e){return a.reduce(function(n,a){return n.then(function(){return a.onNetworkStateChanged(e)})},Promise.resolve())["catch"](function(e){throw n.error(e),e})},o.notifyWifiStateChangeListeners=function(e){return r.reduce(function(n,a){return n.then(function(){return a.onWifiStateChanged(e)})},Promise.resolve())["catch"](function(e){throw n.error(e),e})},o.notifyScanResultsListeners=function(e){return t.reduce(function(n,a){return n.then(function(){return a.onScanResultsAvailable(e)})},Promise.resolve())["catch"](function(e){throw n.error(e),e})},o.addNetworkStateChangeListener=function(e){a.push(e)},o.removeNetworkStateChangeListener=function(e){var n=a.indexOf(e);n>=0&&a.splice(n,1)},o.addWifiStateChangeListener=function(e){r.push(e)},o.removeWifiStateChangeListener=function(e){var n=r.indexOf(e);n>=0&&r.splice(n,1)},o.addScanResultsListener=function(e){t.push(e)},o.removeScanResultsListener=function(e){var n=t.indexOf(e);n>=0&&t.splice(n,1)},o.startService=function(){return new Promise(function(a,r){e.WifiManager?(e.WifiManager.onNetworkStateChanged(function(e){o.notifyNetworkStateChangeListeners(e)},function(e){n.error(e)}),e.WifiManager.onWifiStateChanged(function(e){o.notifyWifiStateChangeListeners(e)},function(e){n.error(e)}),e.WifiManager.onScanResultsAvailable(function(e){o.notifyScanResultsListeners(e)},function(e){n.error(e)}),a()):r("wifimanager plugin not available")})},o.getConnectionInfo=function(){return new Promise(function(n,a){e.WifiManager.getConnectionInfo(function(e){n(e)},function(e){a(e)})})},o.getScanResults=function(){return new Promise(function(n,a){e.WifiManager.getScanResults(function(e){n(e)},function(e){a(e)})})},o.getWifiState=function(){return new Promise(function(n,a){e.WifiManager.getWifiState(function(e){n(e)},function(e){a(e)})})},o.disableNetwork=function(n){return new Promise(function(a,r){e.WifiManager.disableNetwork(function(e){a(e)},function(e){r(e)},{netId:n})})},o}),e.namespace("dff.app.packagepay"),e.define("dff.app.packagepay.CardType",{GIROCARD:"Girocard",MAESTRO:"Maestro",V_PAY:"VPay",MASTER_CARD:"MasterCard",VISA:"VISA",AMERICAN_EXPRESS:"AmericanExpress",DINERS_CLUB:"DinersClub",JCB:"JCB",UNION_PAY:"UnionPay",DISCOVER:"Discover",IKEA_FAMILY:"IKEAFamily",IKANO:"IKANO",UNKNOWN:"Unknown"}),e.define("dff.app.packagepay.CustomerType",{FORWARDER:"Forwarder",LOGISTICIAN_PARTNER:"LogisticianPartner",SHOP:"Shop",AUTOMATED_STATION:"AutomatedStation",PACKAGE_PAY_PRIVATE:"PackagePayPrivate"}),e.define("dff.app.packagepay.GirocardProcess",{ELECTRONIC_CASH:"ElectronicCash",LASTSCHRIFT:"Lastschrift"}),e.define("dff.app.packagepay.GirocardProcessing",{ELECTRONIC_CASH:"ElectronicCash",LASTSCHRIFT_ONLINE:"LastschriftOnline",LASTSCHRIFT_ONLINE_FALLBACK_ELECTRONIC_CASH:"LastschriftOnlineFallbackElectronicCash"}),e.define("dff.app.packagepay.PaymentResult",{SUCCESS:"Success",FAILURE:"Failure",COMMUNICATION_ERROR:"CommunicationError"}),e.define("dff.app.packagepay.ProcessType",{DRIVER:"Driver",SHOP:"Shop",AUTOMATED_STATION:"AutomatedStation"}),e.define("dff.app.packagepay.WHAT",{Unknown:{ordinal:0,name:"Unknown"},Result:{ordinal:1,name:"Result"},ResultList:{ordinal:2,name:"ResultList"},Payment:{ordinal:3,name:"Payment"},PaymentList:{ordinal:4,name:"PaymentList"},SetReplyTo:{ordinal:5,name:"SetReplyTo"},UnsetReplyTo:{ordinal:6,name:"UnsetReplyTo"},Ack:{ordinal:7,name:"Ack"},NewPayment:{ordinal:8,name:"NewPayment"},EndOfTourResult:{ordinal:9,name:"EndOfTourResult"},GotResult:{ordinal:10,name:"GotResult"},EndOfTour:{ordinal:11,name:"EndOfTour"},NAck:{ordinal:12,name:"NAck"},UpdateNeeded:{ordinal:13,name:"UpdateNeeded"},EndOfTourSilent:{ordinal:14,name:"EndOfTourSilent"},Error:{ordinal:15,name:"Error"},SuppressFinish:{ordinal:16,name:"SuppressFinish"},ListTransactions:{ordinal:17,name:"ListTransactions"},MustInitial:{ordinal:18,name:"MustInitial"},CancelProgressDialog:{ordinal:19,name:"CancelProgressDialog"},StartProgressDialog:{ordinal:20,name:"StartProgressDialog"},SAppStartsAction:{ordinal:21,name:"SAppStartsAction"},SAppStopsAction:{ordinal:22,name:"SAppStopsAction"},RunningState:{ordinal:23,name:"RunningState"},ResetToDefaults:{ordinal:24,name:"ResetToDefaults"},StartWLAN:{ordinal:25,name:"StartWLAN"},StartSApp:{ordinal:26,name:"StartSApp"}}),e.define("dff.app.packagepay.VERIFY_ERROR",{UNKNOWN:{ordinal:0,name:"UNKNOWN"},NO_ERROR:{ordinal:1,name:"NO_ERROR"},NO_PACKAGE_PAY_DEFAULTS:{ordinal:2,name:"NO_PACKAGE_PAY_DEFAULTS"},NO_ALLOWED_CARDS:{ordinal:3,name:"NO_ALLOWED_CARDS"},NO_CUSTOMER_TYPE:{ordinal:4,name:"NO_CUSTOMER_TYPE"},NO_CUSTOMER_NUMBER:{ordinal:5,name:"NO_CUSTOMER_NUMBER"},NO_AMOUNT_CARD:{ordinal:6,name:"NO_AMOUNT_CARD"},NO_TRACKING_NUMBER:{ordinal:7,name:"NO_TRACKING_NUMBER"},NO_LOGISTICIAN:{ordinal:8,name:"NO_LOGISTICIAN"},NO_AMOUNT_COD:{ordinal:9,name:"NO_AMOUNT_COD"},DOUBLE_PAYMENT:{ordinal:10,name:"DOUBLE_PAYMENT"},PREVIOUS_PAYMENT_NOT_COMPLETED:{ordinal:11,name:"PREVIOUS_PAYMENT_NOT_COMPLETED"},NO_PACKAGES:{ordinal:12,name:"NO_PACKAGES"},AMOUNT_COD_SMALLER_THAN_AMOUNT_CARD:{ordinal:13,name:"AMOUNT_COD_SMALLER_THAN_AMOUNT_CARD"},PREVIOUS_END_OF_DAY_NOT_COMPLETED:{ordinal:14,name:"PREVIOUS_END_OF_DAY_NOT_COMPLETED"},NO_LOGISTICIAN_BRANCH:{ordinal:15,name:"NO_LOGISTICIAN_BRANCH"},REJECT_WHILE_PROCESSING:{ordinal:16,name:"REJECT_WHILE_PROCESSING"},NO_IP_SET:{ordinal:17,name:"NO_IP_SET"},RECONNECT_SERVICE_AFTER_SAPP_UPDATE:{ordinal:18,name:"RECONNECT_SERVICE_AFTER_SAPP_UPDATE"},MISSING_RECEIPT_SIGNATURE:{ordinal:19,name:"MISSING_RECEIPT_SIGNATURE"},SAPP_NEEDS_UPDATE:{ordinal:20,name:"SAPP_NEEDS_UPDATE"},NO_CONNECTION_TO_PT_START_SAPP:{ordinal:21,name:"NO_CONNECTION_TO_PT_START_SAPP"}}),e.define("dff.app.packagepay.Payment",function(e,n){this.logistician=e,this["package"]=n}),e.define("dff.app.packagepay.Logistician",function(e,n,a,r){this.name=e,this.processType=n,this.ident=a,this.branch=r}),e.define("dff.app.packagepay.EndOfTour",function(){}),e.define("dff.app.packagepay.Package",function(e,n,a,r,t){this.customerType=e,this.customerNumber=n,this.trackingNumber=a,this.amountCard=r,this.amountCOD=t}),e.define("dff.app.packagepay.IncomingMessageLogger",function(e){return{onIncomingMessage:function(n){e.log("Packagepay - incoming message:",n)}}}),e.define("dff.app.packagepay.ServiceConnectionLogger",function(e){return{onServiceConnectionChange:function(n){e.log("Packagepay - service connected:",n)}}}),e.define("dff.app.packagepay.PackagepayService",function(n,a,r,t,o){var i={};return t=t||[],o=o||[],i.notifyIncomingMessageListener=function(e){return t.reduce(function(n,a){return n.then(function(){return a.onIncomingMessage(e)})},Promise.resolve())},i.addIncomingMessageListener=function(e){t.push(e)},i.removeIncomingMessageListener=function(e){var n=t.indexOf(e);n>=0&&t.splice(n,1)},i.notifyServiceConnectionListener=function(e){return o.reduce(function(n,a){return n.then(function(){return a.onServiceConnectionChange(e)})},Promise.resolve())},i.addServiceConnectionChangeListener=function(e){o.push(e)},i.removeServiceConnectionChangeistener=function(e){var n=o.indexOf(e);n>=0&&o.splice(n,1)},i.startService=function(){return new Promise(function(e,r){n.Packagepay?(n.Packagepay.onIncomingMessage(function(e){i.notifyIncomingMessageListener(e)},function(e){a.error(e)}),n.Packagepay.onServiceConnectionChange(function(e){i.notifyServiceConnectionListener(e)},function(e){a.error(e)}),e()):r("Packagepay plugin not available")})},i.sendReplyTo=function(e){return new Promise(function(r,t){n.Packagepay.sendReplyTo(function(e){r(e)},function(e){a.error(e),t(e)},e)})},i.sendPayment=function(n){return i.sendReplyTo({what:e.app.packagepay.WHAT.NewPayment,obj:n})},i.sendEndOfTour=function(n){return i.sendReplyTo({what:e.app.packagepay.WHAT.EndOfTour,obj:n})},i.sendEndOfTourSilent=function(n){return i.sendReplyTo({what:e.app.packagepay.WHAT.EndOfTourSilent,obj:n})},i.sendGotResult=function(n){var a={what:e.app.packagepay.WHAT.GotResult,arg1:n.what.ordinal,xml:n.xml};return i.sendReplyTo(a)},i.listTransactions=function(){return i.sendReplyTo({what:e.app.packagepay.WHAT.ListTransactions})},i.startWLAN=function(){return i.sendReplyTo({what:e.app.packagepay.WHAT.StartWLAN})},i.startSApp=function(){return i.sendReplyTo({what:e.app.packagepay.WHAT.StartSApp})},i.getWhats=function(){return new Promise(function(e,a){n.Packagepay.getWhats(function(n){e(n)},function(e){a(e)})})},i.getVerifyErrors=function(){return new Promise(function(e,a){n.Packagepay.getVerifyErrors(function(n){e(n)},function(e){a(e)})})},i.bindService=function(){return new Promise(function(e,a){n.Packagepay.bindService(function(){e()},function(e){a(e)})})},i.unbindService=function(){return new Promise(function(e,a){n.Packagepay.unbindService(function(){e()},function(e){a(e)})})},i}),e.namespace("dff.app.cordova.toughpadapi"),e.define("dff.app.cordova.toughpadapi.BarcodeLogger",function(e){return{onRead:function(n){e.log("toughpadapi - barcode read:",n)}}}),e.define("dff.app.cordova.toughpadapi.ToughpadApiService",function(e,n,a,r){var t={};return r=r||[],t.notifyBarcodeListener=function(e){return r.reduce(function(n,a){return n.then(function(){return a.onRead(e)})},Promise.resolve())},t.addBarcodeListener=function(e){r.push(e)},t.removeBarcodeListener=function(e){var n=r.indexOf(e);n>=0&&r.splice(n,1)},t.startService=function(){return new Promise(function(a,r){e.ToughpadApi?(e.ToughpadApi.onBarcodeRead(function(e){t.notifyBarcodeListener(e)},function(e){n.error(e)}),a()):r("ToughpadApi plugin not available")})},t})}();